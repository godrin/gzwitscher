<h1>Listing messages of <%=@user.email%> </h1>
<% unless @user==current_user %>
  <% unless @subscribed %>
    <%= button_to 'Subscribe', user_subscriptions_path(@user), :method => :post %>
  <% else %>
    <%= button_to 'Unsubscribe', user_subscription_path(@user,@subscribed), :method => :delete %>
  <% end %>
<% end %>

<table>
  <tr>
    <th>Text</th>
    <th>User</th>
    <th></th>
    <th></th>
  </tr>

<% @messages.each do |message| %>
  <tr>
    <td><%= message.created_at %></td>
    <td><%= message.text %></td>
    <td><%= message.user_id %></td>
    <td><%= link_to 'Show', [message.user,message] %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New Message', new_user_message_path(current_user) %>
